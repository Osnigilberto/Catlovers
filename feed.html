<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Catlovers - Feed</title>
  <link rel="icon" href="assets/favicon2.png" type="image/x-icon">
  <link rel="stylesheet" />
  <script src="https://kit.fontawesome.com/a1d4c0f36c.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="feed.css" />
</head>

<body>
  <nav id="sidebar">
    <div class="sidebar_content">

      <div class="user">
        <a href="profile.html"><img src="./assets/avatar.png" id="user_avatar" alt="Avatar" /></a>
        <p id="user_infos">
          <span class="item-description"></span>
          <span class="item-description">catlovers@example.com</span>
        </p>
      </div>

      <ul id="side_items">
        <li class="side-item active">
          <a href="feed.html">
            <i class="fa-solid fa-home"></i>
            <span class="item-description">Home</span>
          </a>
        </li>
        <li class="side-item">
          <a href="messages.html">
            <i class="fa-solid fa-message"></i>
            <span class="item-description">Messages</span>
          </a>
        </li>
        <li class="side-item">
          <a href="notifications.html">
            <i class="fa-solid fa-bell"></i>
            <span class="item-description">Notification</span>
          </a>
        </li>
        <li class="side-item">
          <a href="friends.html">
            <i class="fa-solid fa-user-group"></i>
            <span class="item-description">Friends</span>
          </a>
        </li>

        <li class="side-item">
          <a href="settings.html">
            <i class="fa-solid fa-gear"></i>
            <span class="item-description">Settings</span>
          </a>
        </li>
      </ul>
    </div>
    <button id="open_btn">
      <i id="open_btn_icon" class="fa-solid fa-cat"></i>
    </button>

  </nav>

  <main class="main">
    <div class="wrapper">
      <div class="main-center">
        <div class="topo-wrapper">

          <div class="profile-card">
            <div class="profile-pic">
              <img src="assets/logocatlovers.png" alt="" />
            </div>

          </div>

          <!--SEARCH BAR-->
          <div class="search-bar">
            <input type="text" placeholder="Search..." />

          </div>
          <button class="publicar-btn">Publicar</button>


        </div>
      </div>
      <!--STORIES-->
      <div class="stories-wrapper">
        <div class="stories-card">
          <div class="profile-pic">
            <img src="assets/profile-1.jpeg" alt="" />
          </div>
          <p class="username"> username </p>
        </div>

        <div class="stories-card">
          <div class="profile-pic">
            <img src="assets/profile-2.jpeg" alt="" />
          </div>
          <p class="username"> username </p>
        </div>

        <div class="stories-card">
          <div class="profile-pic">
            <img src="assets/profile-3.jpeg" alt="" />
          </div>
          <p class="username"> username </p>
        </div>

        <div class="stories-card">
          <div class="profile-pic">
            <img src="assets/profile-1.jpeg" alt="" />
          </div>
          <p class="username"> username </p>
        </div>

        <div class="stories-card">
          <div class="profile-pic">
            <img src="assets/profile-2.jpeg" alt="" />
          </div>
          <p class="username"> username </p>
        </div>

        <div class="stories-card">
          <div class="profile-pic">
            <img src="assets/profile-3.jpeg" alt="" />
          </div>
          <p class="username"> username </p>
        </div>
      </div>

      <!--POST-->

      <div class="post">
        <div class="info">
          <div class="user">
            <div class="profile-pic">
              <img src="assets/avatar.png" alt="" />
            </div>
            <p class="username">Bom Bom</p>
          </div>
          <i class="fas fa-ellipsis-h options"></i>
        </div>
        <img src="assets/catimage.jpeg" class="post-image" />
        <div class="post-content">
          <div class="reaction-wrapper">
            <i class="icon fas fa-heart"></i>
            <i class="icon fas fa-comment"></i>
          </div>
          <p class="likes"> 4,200 likes</p>
          <p class="description"><span>Bom Bom</span>Eu e meu amor antes do problema acontecer...</p>
          <p class="post-time">09/25/2024</p>
        </div>
        <div class="comment-wrapper">
          <img src="assets/avatar.png" class="icon">
          <input type="text" class="comment-box" placeholder="Add a coment">
          <button class="comment-btn">post</button>
        </div>

      </div>
    </div>
    </div>
  </main>

  <script>
    //open btn menu

    document.getElementById('open_btn').addEventListener('click', function () {
      document.getElementById('sidebar').classList.toggle('open-sidebar');
    });


    //criar post
    app.post('/posts', async (req, res) => {
      const { userId, content } = req.body;

      try {
        const result = await pool.query(
          'INSERT INTO posts (user_id, content) VALUES ($1, $2) RETURNING *',
          [userId, content]
        );
        res.status(201).json(result.rows[0]);
      } catch (err) {
        res.status(500).json({ error: 'Erro ao criar o post.' });
      }
    });

    //Adicionar amigo
    app.post('/add-friend', async (req, res) => {
      const { userId, friendId } = req.body;

      try {
        await pool.query(
          'INSERT INTO friendships (user_id, friend_id, status) VALUES ($1, $2, $3)',
          [userId, friendId, 'pending']
        );
        res.status(201).json({ message: 'Solicitação de amizade enviada.' });
      } catch (err) {
        res.status(500).json({ error: 'Erro ao adicionar amigo.' });
      }
    });

    //Aceitar amizade
    app.post('/accept-friend', async (req, res) => {
      const { userId, friendId } = req.body;

      try {
        await pool.query(
          'UPDATE friendships SET status = $1 WHERE user_id = $2 AND friend_id = $3',
          ['accepted', friendId, userId]
        );
        res.status(200).json({ message: 'Amizade aceita.' });
      } catch (err) {
        res.status(500).json({ error: 'Erro ao aceitar amizade.' });
      }
    });





  </script>
</body>

</html>